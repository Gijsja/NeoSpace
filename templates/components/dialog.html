{% macro dialog(id, title, trigger_text="Open Dialog", footer=None) %}
{% from "components/ui_macros.html" import button %}
<!-- 
  Reusable Reactive Dialog Component
  Style: Neubrutalist (NeoSpace)
  Tech: Alpine.js + Tailwind
-->
<div x-data="{ open: false }" @keydown.escape.window="open = false" @open-dialog-{{ id }}.window="open = true"
  @close-dialog-{{ id }}.window="open = false" class="inline-block">
  <!-- Trigger -->
  {{ button(trigger_text, variant='secondary', class='bg-white hover:bg-acid-green', attrs='@click="open = true"') }}

  <!-- Overlay & Modal -->
  <template x-teleport="body">
    <div x-show="open" style="display: none" class="fixed inset-0 z-[60] flex items-center justify-center p-4">
      <!-- Backdrop (Blur) -->
      <div x-show="open" x-transition:enter="transition ease-out duration-200"
        x-transition:enter-start="opacity-0 backdrop-blur-none" x-transition:enter-end="opacity-100 backdrop-blur-sm"
        x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100 backdrop-blur-sm"
        x-transition:leave-end="opacity-0 backdrop-blur-none" @click="open = false"
        class="absolute inset-0 bg-black/20"></div>

      <!-- Modal Panel -->
      <div x-show="open" x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="opacity-0 scale-95 translate-y-4"
        x-transition:enter-end="opacity-100 scale-100 translate-y-0"
        x-transition:leave="transition ease-in duration-200"
        x-transition:leave-start="opacity-100 scale-100 translate-y-0"
        x-transition:leave-end="opacity-0 scale-95 translate-y-4"
        class="relative w-full max-w-lg bg-white border-2 border-black shadow-[8px_8px_0_0_#000] p-6 flex flex-col gap-4 transform transition-all"
        @click.stop>
        <!-- Header -->
        <div class="flex items-center justify-between border-b-2 border-black/10 pb-2">
          <h3 class="text-xl font-black uppercase tracking-tighter">
            {{ title }}
          </h3>
          {{ button(None, icon='ph-bold ph-x', variant='ghost', size='icon', class='w-8 h-8 hover:bg-red-500
          hover:text-white', attrs='@click="open = false"') }}
        </div>

        <!-- Content Slot -->
        <div class="py-2 text-sm font-mono leading-relaxed text-gray-700">
          {{ caller() }}
        </div>

        <!-- Footer (Actions) -->
        <div class="flex justify-end gap-3 pt-4 border-t-2 border-black/10">
          {% if footer %}
          {{ footer() }}
          {% else %}
          {{ button('Cancel', variant='ghost', class='border-2 border-transparent hover:border-black',
          attrs='@click="open = false"') }}
          {{ button('Confirm Action', variant='primary', class='bg-black text-white hover:bg-acid-green
          hover:text-black', attrs='@click="$dispatch(\'' ~ id ~ '-confirm\'); open = false"') }}
          {% endif %}
        </div>
      </div>
    </div>
  </template>
</div>
{% endmacro %}